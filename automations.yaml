- id: '1588587120496'
  alias: 'Living: edissons: motion — turn on'
  description: ''
  trigger:
  - entity_id: binary_sensor.living_motion
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: light.living_main_light
    state: 'off'
  - condition: state
    entity_id: light.living_edisson
    state: 'off'
  action:
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_on
  mode: single
- id: '1588587120497'
  alias: 'Living: Turn off lights when no motion in a while'
  trigger:
  - entity_id: binary_sensor.living_motion
    for: 0:30:00
    platform: state
    to: 'off'
  condition: []
  action:
  - entity_id: light.living_edisson
    service: light.turn_off
  - data: {}
    entity_id: light.living_main_light
    service: light.turn_off
  mode: single
- id: '1588607571701'
  alias: 'Living: Turn on main light when sunset and motion detected'
  description: ''
  trigger:
  - entity_id: binary_sensor.living_motion
    platform: state
    to: 'on'
  condition:
  - condition: and
    conditions:
    - after: sunset
      condition: sun
    - before: sunset
      before_offset: +04:00:00
      condition: sun
  action:
  - data: {}
    entity_id: light.living_main_light
    service: light.turn_on
- id: '1589029647840'
  alias: say hello when mxtnr came back
  description: ''
  trigger:
  - entity_id: device_tracker.inv_phone
    event: enter
    platform: zone
    zone: zone.home
  condition: []
  action:
  - service: shell_command.say_alex_hello
- id: '1589219867446'
  alias: 'Hall: Turn on led stripe at 8:40 '
  description: ''
  trigger:
  - at: '8:40'
    platform: time
  condition: []
  action:
  - data: {}
    entity_id: light.hall_led
    service: light.turn_on
- id: '1589220053566'
  alias: '*: night came'
  description: ''
  trigger:
  - platform: time
    at: '23:59:59'
  condition: []
  action:
  - data: {}
    entity_id: light.hall_led
    service: light.turn_off
  - data: {}
    entity_id: light.hall_wall
    service: light.turn_off
  - data: {}
    service: light.turn_off
    entity_id: light.kitchen_main_light_2
  - data: {}
    service: light.turn_off
    entity_id: light.hallway_main_light
  mode: single
- id: '1589296416725'
  alias: 'Hall: wall switch light'
  description: ''
  trigger:
  - entity_id: binary_sensor.hall_wall_switch_2
    from: 'on'
    platform: state
    to: 'off'
  - platform: state
    entity_id: binary_sensor.hall_wall_switch_2
    from: 'off'
    to: 'on'
  condition: []
  action:
  - data: {}
    entity_id: light.hall_wall
    service: light.toggle
  mode: single
- id: '1589296617107'
  alias: 'Hall: turn off wall light when no motion in a while'
  description: ''
  trigger:
  - for: 00:20:00
    platform: state
    to: 'off'
    entity_id: binary_sensor.entry_door_motion_final
  condition: []
  action:
  - data: {}
    entity_id: light.hall_wall
    service: light.turn_off
  mode: single
- id: '1589315913411'
  alias: '^: Enable automations'
  description: ''
  trigger:
  - at: 08:00:00
    platform: time
  condition: []
  action:
  - data: {}
    entity_id: automation.living_edisson_motion
    service: automation.turn_on
  - data: {}
    entity_id: automation.a_toggle_all_light
    service: automation.turn_on
  - data: {}
    entity_id: automation.turn_off_hall_led_when_night_came
    service: automation.turn_on
  - data: {}
    entity_id: automation.no_purify_if_clean
    service: automation.turn_on
  - service: automation.turn_on
    data: {}
    entity_id: automation.hall_main_door_wall_light
  - service: automation.turn_on
    data: {}
    entity_id: automation.hall_motion_turn_wall_light_on
  mode: single
- id: '1589380016803'
  alias: 'Living: switch edissons on'
  description: ''
  trigger:
  - device_id: 09e58166923343f5bc376ebc11ce7393
    discovery_id: 0x00158d00039a2f89 click_single
    domain: mqtt
    platform: device
    subtype: single
    type: click
  condition:
  - condition: state
    entity_id: light.living_edisson
    state: 'off'
  action:
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_on
  - service: automation.turn_on
    data: {}
    entity_id: automation.living_edisson_motion
  mode: single
- id: '1589380016804'
  alias: 'Living: switch edissons off'
  description: ''
  trigger:
  - device_id: 09e58166923343f5bc376ebc11ce7393
    discovery_id: 0x00158d00039a2f89 click_single
    domain: mqtt
    platform: device
    subtype: single
    type: click
  condition:
  - condition: state
    entity_id: light.living_edisson
    state: 'on'
  action:
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_off
  - data: {}
    entity_id: light.living_main_light
    service: light.turn_off
  - service: automation.turn_off
    data: {}
    entity_id: automation.living_edisson_motion
  - delay: 02:00:00
  - service: automation.turn_on
    data: {}
    entity_id: automation.living_edisson_motion
  mode: single
- id: '1589722525059'
  alias: 'HA: Load plants on restart'
  description: ''
  trigger:
  - event: start
    platform: homeassistant
  condition: []
  action:
  - data: {}
    service: shell_command.update_plants
- id: '1593593886358'
  alias: 'Living: main switch off edissons off'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.living_main_light_switch
    from: 'on'
    to: 'off'
  - platform: state
    entity_id: binary_sensor.living_main_light_switch
    from: 'off'
    to: 'on'
  condition:
  - condition: state
    entity_id: light.living_edisson
    state: 'on'
  - condition: state
    entity_id: light.living_main_light
    state: 'off'
  action:
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_off
  mode: single
- id: '1593597552955'
  alias: '*: Turn all light off'
  description: ''
  trigger:
  - entity_id: sensor.0x00158d00039b3168_click
    platform: state
    to: single
  condition:
  - condition: state
    entity_id: group.all_lights
    state: 'on'
  action:
  - data: {}
    entity_id: light.hall_led
    service: light.turn_off
  - data: {}
    entity_id: light.hall_wall
    service: light.turn_off
  - data: {}
    entity_id: light.hallway_main_light
    service: light.turn_off
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_off
  - data: {}
    entity_id: light.living_main_light
    service: light.turn_off
  - service: light.turn_off
    data: {}
    entity_id: light.bedroom_light
  - service: light.turn_off
    data: {}
    entity_id: light.kitchen_main_light_esp_wc
  - service: light.turn_off
    data: {}
    entity_id: light.kitchen_led
  - service: media_player.turn_off
    data: {}
    entity_id: media_player.q9
  mode: single
- id: '1593597552958'
  alias: '*: Turn all light on'
  description: ''
  trigger:
  - entity_id: sensor.0x00158d00039b3168_click
    platform: state
    to: single
  condition:
  - condition: state
    entity_id: group.all_lights
    state: 'off'
  action:
  - data: {}
    entity_id: light.hall_led
    service: light.turn_on
  - data: {}
    entity_id: light.hall_wall
    service: light.turn_on
  - data: {}
    entity_id: light.living_edisson
    service: light.turn_on
  - data: {}
    entity_id: automation.turn_on_hall_led_stripe_at_8_40
    service: automation.turn_on
  - service: automation.turn_on
    data: {}
    entity_id: automation.living_edisson_motion
  - service: light.turn_on
    data: {}
    entity_id: light.bedroom_light
  - service: light.turn_on
    data: {}
    entity_id: light.kitchen_led
  mode: single
- id: '1599475769646'
  alias: 'Hall: Main door opened — All Light on'
  description: 'Turn all light on when we came back '
  trigger:
  - entity_id: binary_sensor.hall_main_door
    platform: state
    to: 'on'
  condition:
  - condition: state
    entity_id: group.all_lights
    state: 'off'
  action:
  - data: {}
    entity_id: light.hall_wall
    service: light.turn_on
  - data: {}
    entity_id: light.hall_led
    service: light.turn_on
  - data: {}
    entity_id: light.living_main_light
    service: light.turn_on
  - data: {}
    entity_id: automation.turn_on_hall_led_stripe_at_8_40
    service: automation.turn_on
  - service: light.turn_on
    data: {}
    entity_id: light.kitchen_led
  mode: single
- id: '1601754197704'
  alias: 'Purifier: night idle'
  description: ''
  trigger:
  - at: 00:00:00
    platform: time
  condition: []
  action:
  - data: {}
    entity_id: automation.purify_if_dirty
    service: automation.turn_off
  - data: {}
    entity_id: automation.purify_if_dirty_8
    service: automation.turn_off
  mode: single
- id: '1601754311547'
  alias: 'Purifier: morning auto enable'
  description: ''
  trigger:
  - event: sunrise
    offset: 01:00:00
    platform: sun
  condition: []
  action:
  - data: {}
    entity_id: automation.purify_if_dirty
    service: automation.turn_on
  - data: {}
    entity_id: automation.purify_if_dirty_8
    service: automation.turn_on
  mode: single
- id: '1603580145749'
  alias: 'hall: hack entry door motion off'
  description: ''
  trigger:
  - platform: mqtt
    topic: hall/input/hall_motion
    payload: 'ON'
  condition: []
  action:
  - service: input_boolean.turn_on
    data: {}
    entity_id: input_boolean.entry_door_motion
  - delay: '2'
  - service: input_boolean.turn_off
    data: {}
    entity_id: input_boolean.entry_door_motion
  mode: single
- id: '1603580866007'
  alias: 'hall: entrydoor motion turn wall light on'
  description: ''
  trigger:
  - platform: state
    to: 'on'
    entity_id: binary_sensor.entry_door_motion_final
  condition:
  - condition: time
    before: '23:30:00'
    after: '8:00:00'
  action:
  - service: light.turn_on
    data: {}
    entity_id: light.hall_wall_light
  mode: single
- id: '1606064025041'
  alias: 'Hall: Main door — Wall Light'
  description: even if some lights are on
  trigger:
  - platform: state
    entity_id: binary_sensor.hall_main_door
    to: 'on'
  condition: []
  action:
  - service: light.turn_on
    data: {}
    entity_id: light.hall_wall_light
  - service: light.turn_on
    data: {}
    entity_id: light.hall_led
  mode: single
- id: '1606078071869'
  alias: 'Bedroom: light off — all light off'
  description: at evening/night
  trigger:
  - platform: state
    entity_id: light.bedroom_light
    to: 'off'
    for: 00:00:01
  condition:
  - condition: time
    after: 00:30:00
    before: 04:00:00
  action:
  - service: automation.trigger
    data: {}
    entity_id: automation.a_toggle_all_light
  mode: single
- id: '1612899740830'
  alias: 'wc: water: update hot'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.wc_hot_imp
    to: 'on'
  condition: []
  action:
  - service: input_number.increment
    data: {}
    entity_id: input_number.water_hot
  mode: single
- id: '1612899740831'
  alias: 'wc: water: update cold'
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.wc_cld_imp
    to: 'on'
  condition: []
  action:
  - service: input_number.set_value
    data_template:
      entity_id: input_number.water_cold
      value: '{{ float("{:.2f}".format(float(states("input_number.water_cold")) +
        0.01)) }}'
  mode: single
- id: '1613142528014'
  alias: Cleaner took off — All lights on
  description: Режим уборки при снятии пылесоса
  trigger:
  - platform: state
    entity_id: binary_sensor.kitchen_vacuum_cleaner_contact
    to: 'on'
    for: 00:00:01
    from: 'off'
  condition:
  - condition: time
    after: 08:00:00
    before: 02:00:00
  action:
  - service: automation.trigger
    data: {}
    entity_id: automation.turn_all_light_on
  - service: light.turn_on
    data:
      brightness: 255
    entity_id: light.bedroom_light
  - service: light.turn_on
    data: {}
    entity_id: light.hallway_main_light
  - service: light.turn_on
    data: {}
    entity_id: light.living_main_light
  mode: single
- id: '1613172422587'
  alias: 'hall: turn off main light in 40 minutes'
  description: ''
  trigger:
  - platform: state
    entity_id: light.hallway_main_light
    from: 'off'
    to: 'on'
    for: 00:40:00
  condition: []
  action:
  - service: light.turn_off
    data: {}
    entity_id: light.hallway_main_light
  mode: single
- id: '1613332138211'
  alias: Cleaner on baae — light down
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 5c51f6beeb683add8370b54fa3cac566
    entity_id: binary_sensor.kitchen_vacuum_cleaner_contact
    domain: binary_sensor
  condition: []
  action:
  - service: light.turn_off
    data: {}
    entity_id: light.hallway_main_light
  - service: light.turn_off
    data: {}
    entity_id: light.living_main_light
  - service: light.turn_off
    data: {}
    entity_id: light.hall_wall_light
  mode: single
- id: '1613345212576'
  alias: tv on — main light off
  description: ''
  trigger:
  - platform: state
    entity_id: media_player.q9
    to: 'on'
    from: 'off'
  condition: []
  action:
  - service: light.turn_off
    data: {}
    entity_id: light.living_main_light
  mode: single
- id: '1613582192095'
  alias: 'Bedroom: too cold'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.airclimate_temperature_bedroom
    below: '16'
    for: 00:01:00
  condition:
  - condition: state
    entity_id: binary_sensor.bedroom_balc_door
    state: 'on'
  action:
  - repeat:
      while:
      - condition: state
        entity_id: binary_sensor.bedroom_balc_door
        state: 'on'
      - condition: numeric_state
        entity_id: sensor.airclimate_temperature_bedroom
        below: '16'
      sequence:
      - service: tts.google_translate_say
        data:
          message: Close bedroom window. Please, Close bedroom window. Temperature
            is {{ states('sensor.airclimate_temperature_bedroom') }}
          entity_id: media_player.living_rpi4_center
      - wait_template: '{{ 1 }}'
        timeout: 00:00:15
        continue_on_timeout: true
  mode: single
- id: '1613808319719'
  alias: 'Living: tv: Ambient'
  description: ''
  trigger:
  - platform: time
    at: '10:00:00'
  condition:
  - condition: state
    entity_id: media_player.q9
    state: 'off'
  action:
  - service: media_player.turn_on
    data: {}
    entity_id: media_player.q9
  - service: media_player.play_media
    data:
      media_content_type: send_key
      media_content_id: KEY_AMBIENT
    entity_id: media_player.q9
  mode: single
